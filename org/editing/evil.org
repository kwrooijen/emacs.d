#+STARTUP: showeverything

#+BEGIN_SRC emacs-lisp
(defun kwrooijen/insert-euro-symbol ()
  "Inserts the € symbol at the cursor's position."
  (interactive)
  (insert "€"))
#+END_SRC

* Evil
:PROPERTIES:
:PACKAGE: evil
:STRAIGHT: t
:END:

** Config :config:

#+BEGIN_SRC emacs-lisp
(evil-mode 1)
#+END_SRC

Recenter screen when searching forward / backwards
#+BEGIN_SRC emacs-lisp
(advice-add 'evil-search-next :after #'kwrooijen/recenter)
(advice-add 'evil-search-previous :after #'kwrooijen/recenter)
#+END_SRC

** Hook :hook:
#+BEGIN_SRC emacs-lisp
(minibuffer-setup . #'evil-insert-state)
#+END_SRC

** Bindings :general:

#+BEGIN_SRC emacs-lisp
(:states 'insert
         "C-$" 'kwrooijen/insert-euro-symbol)
#+END_SRC

* Evil Collection
:PROPERTIES:
:PACKAGE: evil-collection
:STRAIGHT: t
:AFTER: evil
:END:

** Config :config:

Evil collection makes it very hard to override the `[` key.
#+BEGIN_SRC emacs-lisp
(defvar kwrooijen/intercept-mode-map (make-sparse-keymap))

(define-minor-mode kwrooijen/intercept-mode
  "Intercept evil keys before evil-collection."
  :global t)

(kwrooijen/intercept-mode)

(dolist (state '(normal motion visual))
  (evil-make-intercept-map
   (evil-get-auxiliary-keymap kwrooijen/intercept-mode-map state t t)
   state))

(evil-define-key '(normal motion visual)
  kwrooijen/intercept-mode-map
  "[" #'avy-goto-char)

(evil-collection-init)
#+END_SRC

* Evil Nerd commenter
:PROPERTIES:
:PACKAGE: evil-nerd-commenter
:STRAIGHT: t
:AFTER: evil
:END:

** Bindings :general:

#+BEGIN_SRC emacs-lisp
("M-/" 'evilnc-comment-or-uncomment-lines)
#+END_SRC

* Evil Highlight Persist
:PROPERTIES:
:PACKAGE: evil-search-highlight-persist
:STRAIGHT: t
:END:

** Config :config:
#+BEGIN_SRC emacs-lisp
(global-evil-search-highlight-persist t)
(advice-add 'keyboard-quit :before #'evil-search-highlight-persist-remove-all)
#+END_SRC


* Hl Line
:PROPERTIES:
:PACKAGE:  hl-line
:DEFER: t
:END:

** Config :config:

Disable hl-line-mode when entering visual mode, since hl-line and
visual use the same background.

#+BEGIN_SRC emacs-lisp
(defun kwrooijen/hl-line-off ()
  (hl-line-mode -1))

(defun kwrooijen/hl-line-on ()
  (hl-line-mode 1))

(add-hook 'evil-visual-state-entry-hook #'kwrooijen/hl-line-off)
(add-hook 'evil-visual-state-exit-hook  #'kwrooijen/hl-line-on)
#+END_SRC
