#+PRIORITY: 3

* Embellish
:PROPERTIES:
:PACKAGE: embellish
:END:

Configure theme-dependent settings for embellish and enable
subwindow mode. The base =embellish-mode= is enabled in =init.el=.

** Init :init:

#+BEGIN_SRC emacs-lisp
(load-theme 'embellish-winter-night t)
(embellish-mode 1)
#+END_SRC



* Shr
:PROPERTIES:
:PACKAGE: shr
:DEFER: t
:END:

** Config :config:

#+BEGIN_SRC emacs-lisp
(require 'embellish-font)
(set-face-attribute 'shr-text nil
                    :family embellish-font-family
                    :weight 'light)
#+END_SRC

* Highlight TODO
:PROPERTIES:
:PACKAGE: hl-todo
:STRAIGHT: t
:END:

** Custom :custom:
#+BEGIN_SRC emacs-lisp
(hl-todo-keyword-faces
 '(("TODO"   . "#FF0000")
   ("FIXME"  . "#FF0000")
   ("DEBUG"  . "#A020F0")
   ("GOTCHA" . "#FF4500")
   ("STUB"   . "#1E90FF")))
#+END_SRC

** hook :hook:
#+BEGIN_SRC emacs-lisp
(prog-mode . hl-todo-mode)
#+END_SRC

* Highlight numbers
:PROPERTIES:
:PACKAGE: highlight-numbers
:STRAIGHT: t
:END:
** Hook :hook:
#+BEGIN_SRC emacs-lisp
((prog-mode . highlight-numbers-mode)
 (org-mode . highlight-numbers-mode))
#+END_SRC

* Dimmer
:PROPERTIES:
:PACKAGE: dimmer
:STRAIGHT: t
:END:

** Init :init:
#+BEGIN_SRC emacs-lisp
(require 'dimmer)
#+END_SRC

** Custom :custom:
#+BEGIN_SRC emacs-lisp
(dimmer-fraction 0.8)
(dimmer-watch-frame-focus-events nil)
#+END_SRC

** Config :config:
#+BEGIN_SRC emacs-lisp
(defgroup kwrooijen/minibuffer-dim nil
  "Customization for minibuffer-aware dimming rules."
  :group 'convenience)

(defcustom kwrooijen/minibuffer-dim-excluded-commands
  '(consult-line
    consult-yank-from-kill-ring
    consult-ripgrep
    magit-discard
    anzu-query-replace
    org-schedule
    kwrooijen/consult-ripgrep-symbol-at-point)

  "Commands for which the original window should not be dimmed.
When the minibuffer is activated by one of these commands,
the selected window will be restored (not dimmed)."
  :type '(repeat symbol))

(defun kwrooijen/dimmer-dim-all ()
  "Dim all buffers."
  (mapc (lambda (buf)
          (with-current-buffer buf
            (unless (minibufferp)
              (dimmer-dim-buffer buf dimmer-fraction))))
        (dimmer-visible-buffer-list)))

(defun kwrooijen/minibuffer-dim-all-initialize ()
  "Dim all buffers except for commands listed in `kwrooijen/minibuffer-dim-excluded-commands'."
  (kwrooijen/dimmer-dim-all)
  (when (memq this-command kwrooijen/minibuffer-dim-excluded-commands)
    (dimmer-restore-buffer (window-buffer (minibuffer-selected-window)))))

;;;###autoload
(define-minor-mode kwrooijen/minibuffer-dim-mode
  "Toggle dimming adjustments for Minibuffer."
  :global t
  (if kwrooijen/minibuffer-dim-mode
      (progn
        (add-to-list 'dimmer-exclusion-regexp-list ".*Minibuf.*")

        (add-hook 'minibuffer-setup-hook #'kwrooijen/minibuffer-dim-all-initialize)
        (add-hook 'minibuffer-exit-hook #'dimmer-restore-all))

        (remove-hook 'minibuffer-setup-hook #'kwrooijen/minibuffer-dim-all-initialize)
        (remove-hook 'minibuffer-exit-hook #'dimmer-restore-all)))

(kwrooijen/minibuffer-dim-mode)
#+END_SRC
* Hl line mode
:PROPERTIES:
:PACKAGE: hl-line
:END:

** Hook :hook:
#+BEGIN_SRC emacs-lisp
((prog-mode . hl-line-mode)
 (text-mode . hl-line-mode)
 (messages-buffer-mode . hl-line-mode))
#+END_SRC
