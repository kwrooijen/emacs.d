#+STARTUP: showeverything

* Options

#+BEGIN_SRC emacs-lisp
(defcustom kwrooijen/snippet-directory
  (file-name-concat kwrooijen/emacs-directory "db/snippets")
  "Directory where snippets are stored."
  :type 'string
  :group 'kwrooijen)
#+END_SRC

* Yasnippet
:PROPERTIES:
:PACKAGE: yasnippet
:STRAIGHT: t
:END:

** Config :config:

#+BEGIN_SRC emacs-lisp
(add-to-list 'load-path kwrooijen/snippet-directory)
(add-to-list 'yas-snippet-dirs kwrooijen/snippet-directory)
(let ((yas-snippets-dir (expand-file-name "straight/repos/yasnippet-snippets/snippets" user-emacs-directory)))
  (add-to-list 'load-path kwrooijen/snippet-directory)
  (add-to-list 'yas-snippet-dirs kwrooijen/snippet-directory))
#+END_SRC

#+BEGIN_SRC emacs-lisp
(defun kwrooijen/yas-completing-read (templates)
  "Prompt the user to select a template from TEMPLATES and insert its yasnippet.
TEMPLATES is an alist of (DISPLAY-NAME . SNIPPET-KEY) pairs."
  (interactive)
  (let* ((template-names (mapcar #'car templates))
         (selected (completing-read "Select template: " template-names nil t)))
    (when selected
      (let ((snippet-key (cdr (assoc selected templates))))
        (if (and (featurep 'yasnippet) (yas-lookup-snippet snippet-key))
            (yas-expand-snippet (yas-lookup-snippet snippet-key))
          (error "Yasnippet not available or snippet '%s' not found" snippet-key))))))
#+END_SRC



** Hook :hook:
#+BEGIN_SRC emacs-lisp
((prog-mode . yas-minor-mode)
 (org-mode . yas-minor-mode))
#+END_SRC


** Bindings :general:

#+BEGIN_SRC emacs-lisp
(kwrooijen/leader
  "i s" 'yas-insert-snippet)
#+END_SRC

* Yasnippet snippets
:PROPERTIES:
:PACKAGE: yasnippet-snippets
:STRAIGHT: t
:AFTER: yasnippet
:END:

** Jinx (spell checker)
:PROPERTIES:
:PACKAGE: jinx
:STRAIGHT: t
:END:

** Config :config:
#+BEGIN_SRC emacs-lisp
(defun kwrooijen/jinx-add-word-at-point ()
  "Add the word at point to Jinx personal dictionary."
  (interactive)
  (let ((word (thing-at-point 'word t)))
    (if (not word)
        (user-error "No word at point")
      ;; Call the same save logic that jinx uses for @word
      (jinx--save-personal 'save ?@ word)
      (jinx--recheck-overlays)
      (message "Added '%s' to Jinx personal dictionary" word))))
#+END_SRC

** Custom :custom:
#+BEGIN_SRC emacs-lisp
(jinx-languages "en_US,nl")
;(defun jinx--read-languages ()
;; '("en_US" "nl")
;"en_US,nl"
;(jinx--table-with-metadata '("en_US" "nl") `((group-function . ,#'jinx--group)))
;)

#+END_SRC

** Bindings :general:
#+BEGIN_SRC emacs-lisp
("M-$" 'jinx-correct)
("C-M-$" 'jinx-languages)

(kwrooijen/leader
 "jj" 'kwrooijen/jinx-add-word-at-point)
#+END_SRC

* Copilot
:PROPERTIES:
:PACKAGE: copilot
:STRAIGHT: (:host github :repo "copilot-emacs/copilot.el" :files ("dist" "*.el"))
:END:

** Hooks :hook:
#+BEGIN_SRC emacs-lisp
((prog-mode . copilot-mode))
#+END_SRC

** Bindings :general:
#+BEGIN_SRC emacs-lisp
(:keymaps 'copilot-completion-map
          "M-TAB" 'copilot-accept-completion-by-word
          "M-<tab>" 'copilot-accept-completion-by-word
          "<tab>" 'kwrooijen/tab
          "TAB" 'kwrooijen/tab
          "C-<tab>" 'copilot-next-completion
          "C-TAB" 'copilot-next-completion)

(:states 'insert
  "C-o" 'copilot-next-completion)

("M-O" 'copilot-mode)
#+END_SRC

* Company
:PROPERTIES:
:PACKAGE: company
:STRAIGHT: t
:END:

TODO replace with
https://github.com/minad/corfu
https://github.com/minad/cape

** Bindings :general:
#+BEGIN_SRC emacs-lisp
(:keymaps 'company-active-map
          "C-j" 'company-select-next-or-abort
          "C-k" 'company-select-previous-or-abort
          "C-f" 'company-next-page
          "C-b" 'company-previous-page
          "<escape>" 'company-abort)

("M-;" 'company-complete)
#+END_SRC

** Hook :hook:
#+BEGIN_SRC emacs-lisp
((after-init . global-company-mode))
#+END_SRC

* Company Box
:PROPERTIES:
:PACKAGE: company-box
:STRAIGHT: t
:END:
** Hook :hook:
#+BEGIN_SRC emacs-lisp
(company-mode . company-box-mode)
#+END_SRC


* Aidermacs
:PROPERTIES:
:PACKAGE: aidermacs
:STRAIGHT: t
:END:

** Custom :custom:
#+BEGIN_SRC emacs-lisp
(aidermacs-show-diff-after-change nil)
(aidermacs-auto-commits nil)
(aidermacs-default-chat-mode 'code)
(aidermacs-extra-args '("--no-auto-commits"))
(aidermacs-default-model "openrouter/anthropic/claude-sonnet-4.5")
(aidermacs-weak-model "openrouter/x-ai/grok-code-fast-1")
#+END_SRC

** Config :config:
#+BEGIN_SRC emacs-lisp
(define-advice aidermacs-run (:around (orig-fun &rest args) set-project-root)
  "Run aidermacs-run with default-directory set to project root."
  (let ((default-directory (kwrooijen/project-root)))
    (apply orig-fun args)))
#+END_SRC

** General :general:
#+BEGIN_SRC emacs-lisp
(kwrooijen/leader
"a" 'aidermacs-transient-menu)
#+END_SRC

* Eca
:PROPERTIES:
:PACKAGE:  eca
:STRAIGHT: t
:END:
